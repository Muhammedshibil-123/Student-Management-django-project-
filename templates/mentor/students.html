{% extends 'base_mentor.html' %}

{% block title %}Manage Students{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-6">Your Approved Students</h1>

{% if messages %}
  {% for message in messages %}
    <div class="mb-4 px-4 py-3 rounded relative
                {% if message.tags == 'success' %} bg-green-100 border border-green-400 text-green-700
                {% elif message.tags == 'error' %} bg-red-100 border border-red-400 text-red-700
                {% else %} bg-blue-100 border border-blue-400 text-blue-700
                {% endif %}"
         role="alert">
      <span class="block sm:inline">{{ message }}</span>
    </div>
  {% endfor %}
{% endif %}

<div class="bg-white shadow-lg rounded-lg overflow-hidden">
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Student
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Academic Info
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Contact
          </th>
          <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        
        {% for student in approved_students %}
        <tr>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="flex items-center">
              {% if student.profile_picture %}
                <img class="h-10 w-10 rounded-full object-cover" src="{{ student.profile_picture.url }}" alt="Profile Pic">
              {% else %}
                <div class="h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-xs font-medium text-gray-500">
                  No Pic
                </div>
              {% endif %}
              <div class="ml-4">
                <div class="text-sm font-medium text-gray-900">
                  {{ student.user.first_name }} {{ student.user.last_name }}
                </div>
                <div class="text-sm text-gray-500">
                  @{{ student.user.username }}
                </div>
              </div>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-900">{{ student.course.name|default:'N/A' }}</div>
            <div class="text-sm text-gray-500">
              {{ student.get_year_display|default:'N/A' }} - Div: {{ student.get_division_batch_display|default:'N/A' }}
            </div>
            <div class="text-sm text-gray-500">Roll: {{ student.roll_number|default:'N/A' }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900">{{ student.contact_number|default:'N/A' }}</div>
              <div class="text-sm text-gray-500">{{ student.user.email|default:'N/A' }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-right space-x-2">
            
            <a href="{% url 'mentor_edit_student' student.id %}"
               class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
              Edit
            </a>

          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="px-6 py-12 text-center text-gray-500">
            You have no approved students in your class.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}